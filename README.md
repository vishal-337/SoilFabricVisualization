# Soil Fabric Visualization
<p>This GitHub repository allows you to visualize soil fabric data into 2-dimensional histograms with Fourier series approximation, 3-dimensional spherical histograms, and force chains.</p>
<p>The goal of creating the python toolkit for soil fabric visualization was to observe how sand grains are packed in a confined structure and comprehend how the packing changes as pressure is applied. We can forecast the behavior of granular material under strain by quantifying the internal structure of the material. With the aid of Discrete Element Method (DEM) simulation, thorough details on the internal structure of granular material and the data used to visualize soil fabric were available. This made it possible to comprehend how the grains&apos; packing evolves over time and how external loading affects these changes.</p>
<p><u><strong>2-Dimensional Polar Histogram</strong></u></p>
<p>In order to make a polar histogram to see how a group of vectors are distributed in terms of orientation. The &quot;bin&quot; size was first defined as an angular interval of 10 degrees. Each of these bins is then represented on a graph as a segment of a circle whose radius is proportional to the number of contacts orientated within the bin bounds. The color of each bin represents the average contact force of the bin.&nbsp;</p>
<p>The file &ldquo;normal_Iso.txt&rdquo; and &ldquo;normal_Aniso.txt&rdquo; &nbsp;in this repository contains data of several vectors for isotropic and Anisotropic case respectively, where each row represents a vector with coordinates (x,y,z). For each coordinate, the vector coordinate is calculated and each one is &nbsp;arranged into its respective bins. At the same time, each bin also keeps track of the total contact forces of the vectors falling in the bin, and later each bin is assigned a color according to this total.</p>
<p>The 2-D polar histogram of the file &nbsp;&ldquo;normal_Iso.txt&rdquo; for an Isotropic Case i.e the pressure acting on the soil is uniform in all directions. X-Y, Y-Z, X-Z respectively:</p>
<p><img src="https://lh3.googleusercontent.com/_1l2TyXmBhV2NMZC5VDE_EiG-Fv7rRk3v7uAinTsTonVVLOGzr_4JyRb_fluMRMwBj6tWMzhVnKPXLAKDiMLJ9sfBm4InuHDrNqBW23iA5wy-8gPqO_Sf8yFipP4mACUfmrVgP469K4VEycj0eG6a8KZuVVLaN4dF508LOiNBHF77X7wQ0_8KAWvOpkG" width="624" height="128"></p>
<p><br></p>
<p>The 2-D polar histogram of the file &nbsp;&ldquo;normal_Aniso.txt&rdquo; for an Anisotropic Case i.e the pressure acting on the soil is highest in one direction. X-Y, Y-Z, X-Z respectively:</p>
<p><img src="https://lh5.googleusercontent.com/nEjYgB5ldvrw3hZ2O1BvMm7Q_SqzmwytsDqO3xJLSgObPe5EjwgKaL5qCgCpmAREPpUUdiIolebOc4Ko1L-fp9CqIbXz9Plx7KCfY783vOoVi-PROm2daAUJMZKzS_-rIOXu2fXkFb9tAg2YyFry9diVm9Lv3H2filln0jjyq5A_Q9ejnV28jgTm6DoV" width="186" height="155.6928"><img src="https://lh4.googleusercontent.com/fwl_V3NRUitFEEC9S1r7IOaE_JTQtlV3lVnt0t0fA4pWh51Ci3dXM1MmzJtmhW6wmqF_ioG8I8Ida1NeIkT2C0MG6McplkU81tjqB2e0aOVqhUFmY6JDPiQsjThKwwLGehRDOufnFIc69TiWCzmF-NhvLedHs8NffxZS9JSl49DxKecoNkvr7yOar1RU" width="195" height="151.3939"><img src="https://lh5.googleusercontent.com/6ut63hFkTnJO78CoX4IfMz4uKFbxxPqAZkdL5yVOdeuFdmegBhNSC7-NxhUd6kbkOpnoh47mmXLNBBfTXAOruO88cKGQSmWWC5F4e3uudSVdvHZnIB5B6rwzppY8TQ6IyMnZQyX1xPH1OWVXsvwd0XJBf0ipPbngdAEIUbG-j_OHqzfsz3EaVUCAvwyd" width="197" height="155.9471"></p>
<p><br></p>
<p><strong><u>Fourier Series Approximation</u></strong></p>
<p>Histograms provide discrete interpretation data, limiting our ability to visualize the distribution of orientations to set angular intervals (in this case 10&deg;). The Fourier series provides us with a continuous function, allowing us to approximate the likelihood that a contact normal will have an orientation described by the unit vector. We use a Fourier series expansion containing only two terms for simplicity:</p>
<p><img src="https://lh5.googleusercontent.com/JiaHG9_KCOd6RFCvC6h95m77n3idW4zC_4KI5h4ous7a3TzTuupF8tagK2Mnu1eFFjVa7U91uT6aFOmiOY8EJzGkS63blwt_Ix07TUs0uzdP62fVBNy9wnsyIEz8JyhONaXiHi5oPVJHz_TIpqxREHbfZ7M3tkTvZV0tGXvXCw8F--m2uANcoz4-esm-og" width="219" height="43"></p>
<p>&nbsp;The term &lsquo;a&rsquo; describes the magnitude of fabric anisotropy while the term &lsquo;&theta;a&rsquo; defines the direction of fabric anisotropy. Using the information we already gathered while creating our histogram and some trigonometric manipulation (cos (a - b) = cos a cos b + sin a sin b), we can further break down this formula into the following:</p>
<p><img src="https://lh3.googleusercontent.com/_G_thlmGGLLn7fPTKgVVHQJCkz731U6IlosTHoVTc8TLqb3alTskgBQMZO967-8w7i-n4jThtgKouQLQu2wSE_7qYaJ-nBN04gSN0jUhRpcFqeblINWTQZZWXuvV7RR6jVvUqi5vU2zQOh3o6fIecEh1Yjvh-7l7h-YQtm91U6nde3guLBiFPBC3iaH_MQ" width="353" height="45"></p>
<p>&nbsp;Taking the data set of contact normal orientations, each vector is binned into an angular interval &lsquo;&Delta;&theta;&rsquo; (in this case 10&deg;) centered around an angle &lsquo;&theta;i&rsquo;. Thus, &lsquo;&Delta;Nc(&theta;i)&rsquo; describes the number of contacts in bin &lsquo;i&rsquo;. We normalize this by dividing by the product of &lsquo;Nc&rsquo; and&lsquo;&Theta;i&rsquo;, where &lsquo;Nc&rsquo; is the total number of contact normals.</p>
<p>Using a least squares approximation, we can determine the coefficients (acos2&theta;a/2&pi;) and (asin2&theta;a/2&pi;), which we will call &lsquo;C1&rsquo; and &lsquo;C2&rsquo; respectively. From there, we can use algebraic manipulation to solve for &lsquo;a&rsquo; and &lsquo;&theta;a&rsquo;, completing our Fourier series expansion.</p>
<p><br></p>
<p><img src="https://lh4.googleusercontent.com/vQJ1asFIcDkwX8I7UXHCj7eNnC7CuTEKDRDMXLjUXYCNF27Ji_M-jBSFlqGvWo5juP4QS-bvSJh_IBi8QNiqF03MSswoCEiTApG0lqWdxu49Ts-0hBiSUAQw5FhzAvknLfsrTgx40NHVjNSlglD--Tpe5dmjrfTwIH2b4ni6mPeRPb7Hb_N00CQhkre5Rg" width="254" height="89"></p>
<p><img src="https://lh4.googleusercontent.com/YNcKBFlKVGue3KSurIAs2_vgjGwvzTUOal9lJckLHKoEjL_abc4jyhHReazQVHX9KI-NJvLA7FN9byPnb0sW5Z4hS26ZNPrEQ00MI806czBbznXkQ1zs2vm54owxV2c5k-z4cCbG6L23EwEq7MgPdSU8v6h9KHxlYN3lqUspSd8NX1YhZpnU_bi-RvM8lA" width="236" height="54"><img src="https://lh4.googleusercontent.com/8U9KO7kB1G9P-zrrQFZ-K73BJXPBs-ChCJM2KX0141H9zJjNVe6TKOpmgotVpa6fEpcivnzA-h-rYk5YxcxxezNgg34Fd7DkLl89tAVLjJmKa6tl2-CjdvNm_lTAZS_Mcbw9f3zWTABwRdlF4PeZ7tzQ1Nc4tvCAhR7j1jt3agiUqxDs0CGjP2Ys2h0v_g" width="179" height="51"></p>
<p>The final curve is plotted over our original histogram, giving us the probability distribution of vectors and revealing the preferred orientation of contact normals:&nbsp;</p>
<p><img src="https://lh6.googleusercontent.com/3nzIfZ6I6YhM1TuYrfgdNzrYreT_81yBhGIr010D0tLRb8718kJiTB5FQI9pdZGZ8Q49J4Ie98LZ42hGuZw611J5iEveYHYs41fB-VU2fbjSYMYevTqCnHttVJ--esqcrz4Rm8Twhhl4Ljcdi6tBiXFMfB9sk9ldUe2mazMzAYlxKUkCje5GYNk1DTR-Ew" width="172" height="162"><img src="https://lh6.googleusercontent.com/5qWqNI_0wvPPD04zAWgh83KGDWs7yrye_AuLF18sHV6Xv5vt_ZKLc6bDgAGVT-soFKyeRBfzLuQ4FgpzRXGNRV6Db2OT6gprvSD05mD8yIFkDWzOazKkEqB-usVYYmPXCJAYtNzIRl-OsvZmm2dwyhHtEqVm6dqvOBmtDDJFFCceulC4AdhSc2JYCaUrSw" style="width: 254px; height: 112.426px;"><img src="https://lh5.googleusercontent.com/BBiiEB5GYcuLU4ChaiPVXYT-YE-YBwjuKETHRtIAsboLxszASjIff373Zs5b2sRHoWa5uF6ktMr-XoLxG2pN6k7cpbz0lM97Kv7TcAbHd5bNQ6-PivxvVz66PlytNKogIZ6_P5kWfau8u_Co3oXRMYKQpFGsLqO7-7lAmkrTU-emx8SU0wFFKNADioIdUw" width="179" height="162"></p>
<p><br></p>
<p><br></p>
<p><br></p>
<p><strong><u>3-Dimensional Spherical Histogram</u></strong></p>
<p>The 3-D Spherical Histogram is used to represent the vector distribution in a 3-Dimensional space. The most important aspect is the bin selection in this spherical histogram. The most common method of dividing a unit sphere by latitude and longitude produces bins with equal angles in the azimuthal and polar directions. Since each bin has a varied area, such a bin separation is inappropriate. Each bin needs to have an equal area in order to have a fair vector distribution and to make sure that a vector has the same chance of falling into any bin as a result. This code uses a modified form of sphere latitude/longitude division to guarantee that each bin has an equal area. In our sphere, we have taken the number of longitudinal divisions to be 36 and the latitudinal divisions are 18 the polar angle for each bin is calculated with the formula:</p>
<p><img src="https://lh5.googleusercontent.com/befzx8h6spzWAW6CretQJvGsvpL4-zsHt5Rnc0Ry981keEoW9Cg1X4L9jQxZ10lBmhk-d9jeW9kByHASPrUaFLJJ-niZD9PXyvqzY9hq4ApW9-aCPwVi_kSjaw-WPEJIvCyS9j01BBu8CzMN0jggwCYBbF93xuHoKtmzgAmyPV-MTY1YX80hiuxUPAQ_" width="338" height="96"></p>
<p>Each bin is assigned a color according to the number of vectors falling in the bin.</p>
<p>The file &apos;normal_Aniso.txt&apos; in this repository contains data of several vectors where each row represents a vector with coordinates (x,y,z). The distribution of this vector data, with Long_div=36 and Lat_div=18, is as follows</p>
<p><img src="https://lh6.googleusercontent.com/hur1mOjijmGoHxmqwBsLRGzp6-3lyxUZ8C2yekFN8ycJHpgwHhxlo4Yo04e24DO4fb5amyfU8aFREVF-5jKp0VybToWwGu3mC2X8_zWwmIVDhozM16Saa_G6GkN9sEZXL88v8hUAetgyu6OLs5cj8pTKxp_YS3yeFMFxteBhpfzHmm_ZAOltUiJBNGed4Q" width="624" height="180.01609331074025"></p>
<p><br></p>
<p><br></p>
<p>The file&nbsp;&apos;normal_Iso.txt&apos;&nbsp;in this repository contains data of several vectors where each row represents a vector with coordinates (x,y,z). The distribution of this vector data, with Long_div=36 and Lat_div=18, is as follows</p>
<p><img src="https://lh5.googleusercontent.com/Q7gmXn8SVPFFH9jGrGguszjtQjfRWhGEJCoT6cCpChbkGdBgIdKfOtXqRsSd8x-Q2LyAchP7Fg8l1lMaUsGe9BJRnxr4rnxbKgkwlHUyjlbJKqgHxu7gG19AZX3pJw2tYwOznGFI2pZ1qGXkn38_XZluasGLTU0QmdHb-UwcVQDij4QR1B6wFvBPmQEFqg" width="624" height="188.93243985941652"></p>
<p><br></p>
<p><u><strong>Force Chains</strong></u></p>
<p>The particles of soil are packed in a constrained structure. Contact vectors connecting particle centers are illustrated in the force chain. The thickness of each line is proportional to the magnitude of the force. Each line is assigned a color according to the magnitude of the force.</p>
<p>To graph a force chain the position of all the soil particles is taken from the &rdquo;pos.txt&rdquo; file and from the &ldquo;normals.txt&rdquo; file the vectors connecting different particles are taken and the lines are mapped on the graph according to positions of the particles and according to the magnitude of the contact force.</p>
<p>Force chains are essential as they help us understand the stress transmission in granular material and are utilized in analyzing mechanisms like arching and shearing in a qualitative manner and make it easier to differentiate strong and weak force chains. The Strong and weak force chains have differing and important roles to understand the geotechnical behavior of soils.</p>
<p>The force chain of the files &nbsp;&ldquo;post.txt&rdquo; and &ldquo;normals.txt&rdquo; is as follows:<img src="https://lh3.googleusercontent.com/yMS5l4TEkcPWtXJ9AJUdeVsDbRPBRtbizdBW-qMTe7v3BXoEGW5N1UA6_xK9fbQuX6-gZbdWFunnUmUkRgqU6_tM3p8ovc3WTUNeeTEpQhe4b5OIZo1-BIcuZcjS8m_JtuBuMNOQqxKCN_byhsfufmmpaiQonSrUMTrzPueQDDkBj-9I0qNOjIEQi5gxpA" width="458.335" height="305.7354"></p>
<p><br></p>
